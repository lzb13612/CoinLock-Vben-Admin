<template>
  <antd-generate-form ref="generateFormRef" :data="widgetForm">
  </antd-generate-form>
  <a-button type="primary" @click="handleSubmit">提交</a-button>
</template>

<script lang="ts">
import { defineComponent, reactive, toRefs } from 'vue'
import Web3 from 'web3'

export default defineComponent({
  setup() {
    const state = reactive({
      generateFormRef: null,
      widgetForm: {"list":[{"label":"代币全称","type":"input","options":{"width":"50%","defaultValue":"","placeholder":"","maxlength":null,"prefix":"","suffix":"","addonBefore":"","addonAfter":"","disabled":false,"allowClear":false,"readonly":false,"rules":{"trigger":"blur","enum":"","message":"","pattern":"","required":true,"type":"any"}},"key":"bf974ebfe34d46a687430e2fcde9f55c","model":"input_bf974ebfe34d46a687430e2fcde9f55c","rules":[]},{"label":"代币简称","type":"input","options":{"width":"50%","defaultValue":"","placeholder":"","maxlength":null,"prefix":"","suffix":"","addonBefore":"","addonAfter":"","disabled":false,"allowClear":false,"readonly":false,"rules":{"trigger":"blur","enum":"","message":"","pattern":"","required":true,"type":"any"}},"key":"014350bf3dfd438e86d277cf3f583b40","model":"input_014350bf3dfd438e86d277cf3f583b40","rules":[]},{"label":"代币精度","type":"input","options":{"width":"50%","defaultValue":"","placeholder":"精度一般推荐填18","maxlength":null,"prefix":"","suffix":"","addonBefore":"","addonAfter":"","disabled":false,"allowClear":false,"readonly":false,"rules":{"trigger":"blur","enum":"","message":"","pattern":"","required":true,"type":"any"}},"key":"f9bfd276996248c59de4da8bf5d00d58","model":"input_f9bfd276996248c59de4da8bf5d00d58","rules":[]},{"label":"代币总量","type":"input","options":{"width":"50%","defaultValue":"","placeholder":"","maxlength":null,"prefix":"","suffix":"","addonBefore":"","addonAfter":"","disabled":false,"allowClear":false,"readonly":false,"rules":{"trigger":"blur","enum":"","message":"","pattern":"","required":true,"type":"any"}},"key":"56c822ee82554473a637104f7df86030","model":"input_56c822ee82554473a637104f7df86030","rules":[]},{"label":"选择模板","type":"select","options":{"defaultValue":"无税通用模板","width":"180px","mode":null,"placeholder":"","remote":false,"showLabel":false,"showSearch":false,"clearable":false,"disabled":false,"props":{"label":"label","value":"value"},"options":[{"label":"Option 1","value":"无税通用模板"},{"label":"Option 2","value":"有税回流模板"},{"label":"Option 3","value":"持币分红模板"},{"label":"Option 4","value":"加池分红模板"}],"remoteOptions":[],"remoteFunc":"https://raw.githubusercontent.com/fuchengwei/vue-form-create/master/mock/mock.json","rules":{"trigger":"blur","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"1c6077ce7e14498389715917e95db563","model":"select_1c6077ce7e14498389715917e95db563","rules":[]},{"label":"最低分红标准","type":"input","options":{"width":"50%","defaultValue":"","placeholder":"","maxlength":null,"prefix":"","suffix":"","addonBefore":"","addonAfter":"","disabled":false,"allowClear":false,"readonly":false,"rules":{"trigger":"blur","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"fc91401c13f241e4a3be6dc11ffef48d","model":"input_fc91401c13f241e4a3be6dc11ffef48d","rules":[]},{"label":"分红代币","type":"select","options":{"defaultValue":"BNB","width":"180px","mode":null,"placeholder":"","remote":false,"showLabel":false,"showSearch":false,"clearable":false,"disabled":false,"props":{"label":"label","value":"value"},"options":[{"label":"Option 1","value":"BNB"},{"label":"Option 2","value":"BUSD"},{"label":"Option 3","value":"CAKE"}],"remoteOptions":[],"remoteFunc":"https://raw.githubusercontent.com/fuchengwei/vue-form-create/master/mock/mock.json","rules":{"trigger":"blur","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"85f6eef8f5ce45afaf7b4f370e9173e8","model":"select_85f6eef8f5ce45afaf7b4f370e9173e8","rules":[]},{"label":"买入税率 %","type":"text","options":{"defaultValue":""},"key":"9d0e692fd3474b1cbe6c9720e44a92e9","model":"text_9d0e692fd3474b1cbe6c9720e44a92e9","rules":[]},{"label":"销毁税：","type":"input","options":{"width":"20%","defaultValue":"","placeholder":"","maxlength":null,"prefix":"","suffix":"","addonBefore":"","addonAfter":"","disabled":false,"allowClear":false,"readonly":false,"rules":{"trigger":"change","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"6cf1bfd29fa64726981d43d0b3ab9123","model":"input_6cf1bfd29fa64726981d43d0b3ab9123","rules":[]},{"label":"营销税：","type":"input","options":{"width":"20%","defaultValue":"","placeholder":"","maxlength":null,"prefix":"","suffix":"","addonBefore":"","addonAfter":"","disabled":false,"allowClear":false,"readonly":false,"rules":{"trigger":"change","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"265578d3291a42a7b4f6ff2543e3d584","model":"input_265578d3291a42a7b4f6ff2543e3d584","rules":[]},{"label":"回流税：","type":"input","options":{"width":"20%","defaultValue":"","placeholder":"","maxlength":null,"prefix":"","suffix":"","addonBefore":"","addonAfter":"","disabled":false,"allowClear":false,"readonly":false,"rules":{"trigger":"change","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"fb194bbc35df4d5a8ed86fff846d7c5f","model":"input_fb194bbc35df4d5a8ed86fff846d7c5f","rules":[]},{"label":"分红税：","type":"input","options":{"width":"20%","defaultValue":"","placeholder":"","maxlength":null,"prefix":"","suffix":"","addonBefore":"","addonAfter":"","disabled":false,"allowClear":false,"readonly":false,"rules":{"trigger":"change","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"21893761ca9a41bebaaec131c6b6a6b0","model":"input_21893761ca9a41bebaaec131c6b6a6b0","rules":[]},{"label":"卖出税率 %","type":"text","options":{"defaultValue":""},"key":"697c12ee2e8a424598869212b3dd278d","model":"text_697c12ee2e8a424598869212b3dd278d","rules":[]},{"label":"销毁税：","type":"input","options":{"width":"20%","defaultValue":"","placeholder":"","maxlength":null,"prefix":"","suffix":"","addonBefore":"","addonAfter":"","disabled":false,"allowClear":false,"readonly":false,"rules":{"trigger":"change","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"693de834e3ce4f4fb3092ff36acadb6c","model":"input_693de834e3ce4f4fb3092ff36acadb6c","rules":[]},{"label":"营销税：","type":"input","options":{"width":"20%","defaultValue":"","placeholder":"","maxlength":null,"prefix":"","suffix":"","addonBefore":"","addonAfter":"","disabled":false,"allowClear":false,"readonly":false,"rules":{"trigger":"change","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"17bd6bb81f1a4151a3abb4efde82c055","model":"input_17bd6bb81f1a4151a3abb4efde82c055","rules":[]},{"label":"回流税：","type":"input","options":{"width":"20%","defaultValue":"","placeholder":"","maxlength":null,"prefix":"","suffix":"","addonBefore":"","addonAfter":"","disabled":false,"allowClear":false,"readonly":false,"rules":{"trigger":"change","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"50b064c9eddf498db5ec5a20f41b5b84","model":"input_50b064c9eddf498db5ec5a20f41b5b84","rules":[]},{"label":"分红税：","type":"input","options":{"width":"20%","defaultValue":"","placeholder":"","maxlength":null,"prefix":"","suffix":"","addonBefore":"","addonAfter":"","disabled":false,"allowClear":false,"readonly":false,"rules":{"trigger":"change","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"503b2a1ee2734bacad4db5e3797038fd","model":"input_503b2a1ee2734bacad4db5e3797038fd","rules":[]},{"label":"营销钱包：","type":"input","options":{"width":"50%","defaultValue":"","placeholder":"","maxlength":null,"prefix":"","suffix":"","addonBefore":"","addonAfter":"","disabled":false,"allowClear":false,"readonly":false,"rules":{"trigger":"blur","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"e64776eef3a64a3e82ca7c3be52733dc","model":"input_e64776eef3a64a3e82ca7c3be52733dc","rules":[]},{"label":"选择底池","type":"select","options":{"defaultValue":"BNB","width":"200px","mode":null,"placeholder":"","remote":false,"showLabel":false,"showSearch":false,"clearable":false,"disabled":false,"props":{"label":"label","value":"value"},"options":[{"label":"Option 1","value":"BNB"},{"label":"Option 2","value":"BUSD"}],"remoteOptions":[],"remoteFunc":"https://raw.githubusercontent.com/fuchengwei/vue-form-create/master/mock/mock.json","rules":{"trigger":"change","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"4fb656ca1d154c17a8b4491d5b1f9df0","model":"select_4fb656ca1d154c17a8b4491d5b1f9df0","rules":[]},{"label":"选择交易所","type":"select","options":{"defaultValue":"Pancakeswap","width":"200px","mode":null,"placeholder":"","remote":false,"showLabel":false,"showSearch":false,"clearable":false,"disabled":false,"props":{"label":"label","value":"value"},"options":[{"label":"Option 1","value":"Pancakeswap"}],"remoteOptions":[],"remoteFunc":"https://raw.githubusercontent.com/fuchengwei/vue-form-create/master/mock/mock.json","rules":{"trigger":"change","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"ba68a3bc4a8043f0af2baa553518b5d4","model":"select_ba68a3bc4a8043f0af2baa553518b5d4","rules":[]},{"label":"手动开启交易:","type":"switch","options":{"defaultValue":false,"disabled":false,"checkedChildren":"","unCheckedChildren":"","rules":{"trigger":"blur","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"c12668d474954f57a450f4dd9af26640","model":"switch_c12668d474954f57a450f4dd9af26640","rules":[]},{"label":"杀区块:","type":"switch","options":{"defaultValue":false,"disabled":false,"checkedChildren":"","unCheckedChildren":"","rules":{"trigger":"blur","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"90ff02342ba34245b24146d420d1f69e","model":"switch_90ff02342ba34245b24146d420d1f69e","rules":[]},{"label":"区块数量：","type":"input","options":{"width":"30%","defaultValue":"","placeholder":"","maxlength":null,"prefix":"","suffix":"","addonBefore":"","addonAfter":"","disabled":false,"allowClear":false,"readonly":false,"rules":{"trigger":"change","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"4d0a9d7275344cce958c8b9f79c606d9","model":"input_4d0a9d7275344cce958c8b9f79c606d9","rules":[]},{"label":"税率开关:","type":"switch","options":{"defaultValue":false,"disabled":false,"checkedChildren":"","unCheckedChildren":"","rules":{"trigger":"blur","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"44f43aac54024cbd99b5ffa6b8131a8b","model":"switch_44f43aac54024cbd99b5ffa6b8131a8b","rules":[]},{"label":"转账扣费开关:","type":"switch","options":{"defaultValue":false,"disabled":false,"checkedChildren":"","unCheckedChildren":"","rules":{"trigger":"blur","enum":"","message":"","pattern":"","required":false,"type":"any","len":""}},"key":"10c3d5f5bca74174915f265c218f61aa","model":"switch_10c3d5f5bca74174915f265c218f61aa","rules":[]},{"label":"地址裂变:","type":"switch","options":{"defaultValue":false,"disabled":false,"checkedChildren":"","unCheckedChildren":"","rules":{"trigger":"blur","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"9eab85574e004236a299481df305b60e","model":"switch_9eab85574e004236a299481df305b60e","rules":[]},{"label":"最大裂变数量：","type":"input","options":{"width":"30%","defaultValue":"","placeholder":"","maxlength":null,"prefix":"","suffix":"","addonBefore":"","addonAfter":"","disabled":false,"allowClear":false,"readonly":false,"rules":{"trigger":"change","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"c0765cb120ba418387efafeaea0d095b","model":"input_c0765cb120ba418387efafeaea0d095b","rules":[]},{"label":"黑名单功能:","type":"switch","options":{"defaultValue":false,"disabled":false,"checkedChildren":"","unCheckedChildren":"","rules":{"trigger":"blur","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"ff257a4326024904af63fe8497bad096","model":"switch_ff257a4326024904af63fe8497bad096","rules":[]},{"label":"限制交易:","type":"switch","options":{"defaultValue":false,"disabled":false,"checkedChildren":"","unCheckedChildren":"","rules":{"trigger":"blur","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"d246e062b89d4ced971bd8a7fbf91ff9","model":"switch_d246e062b89d4ced971bd8a7fbf91ff9","rules":[]},{"label":"买入:","type":"input","options":{"width":"40%","defaultValue":"","placeholder":"限制最大买入数量","maxlength":null,"prefix":"","suffix":"","addonBefore":"","addonAfter":"","disabled":false,"allowClear":false,"readonly":false,"rules":{"trigger":"change","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"6d366a320a82475097486212cdfaaa6e","model":"input_6d366a320a82475097486212cdfaaa6e","rules":[]},{"label":"卖出:","type":"input","options":{"width":"40%","defaultValue":"","placeholder":"限制最大卖出数量","maxlength":null,"prefix":"","suffix":"","addonBefore":"","addonAfter":"","disabled":false,"allowClear":false,"readonly":false,"rules":{"trigger":"change","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"cbf4426a461f47c98ce72ff33adf5316","model":"input_cbf4426a461f47c98ce72ff33adf5316","rules":[]},{"label":"限制最大持币量:","type":"switch","options":{"defaultValue":false,"disabled":false,"checkedChildren":"","unCheckedChildren":"","rules":{"trigger":"blur","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"ae21a6c037a1472e8f9a3834099b9f8b","model":"switch_ae21a6c037a1472e8f9a3834099b9f8b","rules":[]},{"label":"最大持币数量","type":"input","options":{"width":"30%","defaultValue":"","placeholder":"","maxlength":null,"prefix":"","suffix":"","addonBefore":"","addonAfter":"","disabled":false,"allowClear":false,"readonly":false,"rules":{"trigger":"change","enum":"","message":"","pattern":"","required":false,"type":"any"}},"key":"1325ba98ca5e498e84eb8391b27e0bb6","model":"input_1325ba98ca5e498e84eb8391b27e0bb6","rules":[]}],"config":{"size":"default","hideRequiredMark":false,"layout":"horizontal","labelAlign":"right","labelCol":{"span":2,"offset":6}}}
    })

    const handleSubmit = () => {
      state.generateFormRef.getData().then(async (data) => {
        console.log(data)
        if ((window as any).web3) {
          (window as any).web3 = new Web3((window as any).web3.currentProvider);        // data success
        } else {
          // .... 用户没有连接, 进行弹窗
        }
        const web3 = (window as any).web3;
        const accounts = await web3.eth.getAccounts();
        console.log("账户", accounts[0])
        


        // data 表单数据
      }).catch(error => {
        // data failed
      })
    }

    return {
      ...toRefs(state),
      handleSubmit
    }
  }
})
</script>
    
